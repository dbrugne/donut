<% if (withBlock) { %>
<div class="block message" data-username="<%= data.username %>">
    <div class="avatar open-user-profile" data-username="<%= data.username %>"
         style="background-image: url(<%= data.avatar %>)"></div>
    <div class="username open-user-profile" data-username="<%= data.username %>">@<%= data.username %></div>
    <div class="items">
        <% } %>
        <div class="event <% if (spammed) { %>spammed<% } %><% if (unviewed) { print('unviewed'); } %>"
             id="<%= data.id %>" data-time="<%= data.time %>"
        <% if (spammed === true) { %>data-spammed="true"<% } %>>
        <div class="ctn">
            <% if (data.message) { %>
            <div class="text"><%= data.message %></div>
            <% } %>
            <% if (data.images) { %>
            <div class="images">
                <% _.each(data.images, function(i) { %>
                <a class="image"
                   data-toggle="image-popover"
                   data-placement="top"
                   target="_blank"
                   href="<%=i.url%>"
                   style="background-image: url(<%= i.thumbnail %>);"></a>
                <% }); %>
                <hr>
            </div>
            <% } %>
            <% if (spammed) { %>
            <div class="text-spammed"><%= t('chat.message.text-spammed') %></div>
            <% } %>
        </div>
        <div class="date pull-right"><span class="moment" data-time="<%= data.time %>" title="<%= data.datefull %>"><%= data.dateshort %></span>
        </div>
        <!--Only display for room messages-->
        <% if (type === 'room:message') { %>
        <div class="actions">
            <a class="message-menu" data-toggle="dropdown" role="button" aria-expanded="false" id="messageMenu">
                <i class="icon icon-cog"></i>
            </a>
            <div class="dropdown-menu" aria-labelledby="messageMenu"><!-- message dropdown menu content --></div>
        </div>
        <% } %>
    </div>
    <% if (withBlock) { %>
</div>
<% } %>