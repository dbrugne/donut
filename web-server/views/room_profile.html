<% layout('profile') %>
<% var roomOpsLength = (typeof room.op !== 'undefined' ? room.op.length : 0 ) %>
<% var roomUsersLength = (typeof room.users !== 'undefined' ? room.users.length : 0 ) %>

<div class="side dc-back" style="<% if (poster) { %>background-image: url(<%= poster %>);<% }; %>">
    <div class="blur dc-back-darker" style="<% if (posterBlured) { %>background-image: url(<%= posterBlured %>);<% }; %>">
        <div class="users hidden-sm hidden-xs">
            <div class="header">
                <p class="count">
                    <%= t('chat.userscount', {count: (1 + roomOpsLength + roomUsersLength)}) %>
                </p>
            </div>
            <hr>
            <ul class="list">

                <li>
                    <a href="/user/<%= room.owner.username%>" class="item owner">
                        <span class="infos">
                            <span class="avatar open-user-profile" data-username="<%= room.owner.username %>"  style="background-image: url(<%= room.owner.avatar %>)" title="<%= t('chat.owner.is') %>"></span>
                            <span class="username open-user-profile" data-username="<%= room.owner.username %>" >@<%= room.owner.username %></span>
                        </span>
                    </a>
                </li>
                <% _.each(room.op, function(user) { %>
                <li>
                    <a href="/user/<%= user.username%>" class="item op">
                        <span class="infos">
                            <span class="avatar open-user-profile" data-username="<%= user.username %>"  style="background-image: url(<%= user.avatar %>)" title="<%= t('chat.op.is') %>"></span>
                            <span class="username open-user-profile" data-username="<%= user.username %>" title="<%= t('global.'+user.status) %>">@<%= user.username %></span>
                        </span>
                    </a>
                </li>
                <% }); %>
                <% _.each(room.users, function(user) { %>
                <li>
                    <a href="/user/<%= user.username%>" class="item <% if (user.is_op === true) { %>op<% }; %> <% if (user.is_owner === true) { %>owner<% }; %> <% if (user.is_devoice === true) { %> devoice<% }; %> <%= user.status %>">
                        <span class="infos">
                            <span class="avatar open-user-profile" data-username="<%= user.username %>"  style="background-image: url(<%= user.avatar %>)" title=""></span>
                            <span class="username open-user-profile" data-username="<%= user.username %>" title="<%= t('global.'+user.status) %>">@<%= user.username %></span>
                        </span>
                    </a>
                </li>
                <% }); %>

            </ul>
            <div class="clearfix"></div>
        </div>
    </div>
</div><!-- /.side -->
<div class="content">
    <div class="header room">
        <div class="overlay-ctn">
            <img class="avatar open-room-profile" data-room-name="<%= room.name %>" src="<%= room.avatar %>" alt="<%= room.name %> avatar">
            <p class="join hidden-sm hidden-xs"><a class="dc-back dc-text-contrast" href="<%= room.join %>"><%= t('actions.join') %> <% if (room.usersCount) { %><%= room.usersCount %><% } %> <i class="icon icon-user-custom"></i></a></p>
        </div>
        <div class="info">
            <div class="name open-room-profile hidden-xs hidden-sm" data-room-name="<%= room.name %>"><%= room.name %></div>
            <div class="share hidden-xs hidden-sm">
                <%= t('chat.share.label') %>
                <i class="facebook icon icon-facebook-square" data-url="<%- room.url %>" data-name="<%- room.name %>" data-avatar="<%- room.avatar %>"></i>
                <i class="twitter icon icon-twitter-square" data-url="<%- room.url %>" data-name="<%- room.name %>"></i>
                <i class="googleplus icon icon-google-plus-square" data-url="<%- room.url %>"></i>
            </div>
            <div class="name open-room-profile visible-xs visible-sm dc-text-contrast" data-room-name="<%= room.name %>" data-colorify-text="contrast" ><%= room.name %></div>
            <% if (room.owner && room.owner.username) { %>
                <br/>
                <div class="owner">
                    <%= t('global.by') %> <a href="<%= room.owner.url %>" <% if (room.color) { %>style="color: <%= room.color %>;"<% } %>>@<%= room.owner.username %></a>
                </div>
            <% } %>
            <% if (room.website) { %>
                <% if (room.owner) { %><span class="separation hidden-sm hidden-xs">|</span><% } %>
                <span class="website hidden-sm hidden-xs" <% if (room.color) { %>style="color: <%= room.color %>;"<% } %>>
                    <%= room.website %>
                </span>
            <% } %>
            <% if (room.description) { %>
                <div class="description hidden-sm hidden-xs">
                    <p class="description-content"><%= room.description %></p>
                </div>
            <% } %>
        </div>
    </div>
    <div class="events">
        <div class="scrollable">
            <input type="hidden" name="id" value="<%= room._id %>"><!-- petit curieux -->

            <p class="title"><%= t('profile.room.ownerops') %></p>
            <div class="users cards">
                <% if (room.owner) { %><%= partial('user', {_user: room.owner}) %><% } %>
                <% _.each(room.op, function(_op) { print(partial('user', {_user: _op}));  }); %>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div><!-- /.content -->





