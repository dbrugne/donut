{% extends "layout.twig.html" %}

{% block title %}chat!{% endblock %}

{% block content %}
<div id="chat">
    <section id="rooms">
        <div class="panel panel-default">
            <div class="panel-body" style="position: relative;">
                You are
                <button type="button" id="status" class="" style="position: absolute; right: 15px;">...</button>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">Rooms</div>
            <div id="rooms-list" class="list-group">
                <!-- Default room -->
                <a href="#" class="list-group-item room-item default" data-room-id="default">&nbsp;</a>
                <!-- / Default room -->
            </div>
            <div class="panel-footer"><a href="#">Find rooms to join <span class="glyphicon glyphicon-plus"></span></a></div>
        </div>
    </section>
    <div id="main">
        <!-- Default room column -->
        <div class="room-container" data-room-id="default">
            <section class="default">Not in room</section>
        </div>
        <!-- / Default room column -->
    </div>
    <section id="users">
        <!-- Default user list -->
        <div class="panel panel-default users-list" data-room-id="default">
            <div class="panel-heading">Users</div>
            <div class="list-group">
                <a href="#" class="list-group-item user-item default">&nbsp;</a>
            </div>
        </div>
        <!-- / Default user list -->
    </section>
</div>

{% endblock %}

{% block endofpage %}
<script src="/js/when.js"></script>
<script src="/js/autobahn.js"></script>
<script src="/js/transport.js"></script>
<script src="/js/chat.js"></script>
<script>
$(document).ready(function() {
    //$( ".room-container" ).first().show();
    //$( ".users-list" ).first().show();
    //$( ".room-item" ).first().addClass('active');
    $( "body" ).on( "click", ".room-item", function () {
        var roomId = $(this).data('room-id');

        // Room list
        $( ".room-item").removeClass('active');
        $('.room-item[data-room-id="'+roomId+'"]').addClass('active');

        // Room content
        $( ".room-container" ).hide();
        $('.room-container[data-room-id="'+roomId+'"]').show();

        // User list
        $( ".users-list" ).hide();
        $('.users-list[data-room-id="'+roomId+'"]').show();
    });
//    $( ".room-item" ).click(function() {
//    });
    $(".messages").each( function() {
        chatScrollDown(this);
    });

});
</script>
{% endblock %}